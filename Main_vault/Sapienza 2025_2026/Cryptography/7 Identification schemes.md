**Tags:** #Cryptography #IdentificationSchemes #IDS #SigmaProtocols #ZeroKnowledge #ZK #Schnorr #FiatShamir #InteractiveProofs #HonestVerifier  

---

## 7.1 Σ-protocols and Zero-Knowledge

An **Identification Scheme (IDS)** is a protocol where **Peggy the Prover ($P$)** proves to **Victor the Verifier ($V$)** that she is who she says she is.
* **Identity:** Encoded in a public key $y$ and a private key $a$.
* **Mechanism:** Peggy proves she has knowledge of $a$ (e.g., [[5 Number theory in cryptography#Assumption 5.1: DL Assumption|discrete log]] of $y$) without necessarily revealing $a$.

**Correctness Requirement:**
The protocol must have **Perfect Correctness**: if Peggy knows the key and follows the protocol, Victor must accept with probability 1.

##### Definition 7.1: Identification Scheme
> [!def] Definition 7.1
> A triple $\Pi = (KGen, P, V)$ is an **Identification Scheme (IDS)** when:
> * $(pk, sk) \in_R KGen(1^\lambda)$.
> * $P(pk, sk)$ and $V(pk)$ are PPT algorithms.
> * **Interaction:** $P$ tries to prove knowledge of $sk$ to $V$. The set of messages exchanged is a **transcript** $\tau$.
> * **Verification:** A random variable $out(P \rightleftarrows V)(\tau)$ is 1 if $V$ accepts, 0 otherwise.
> * **Perfect Correctness:** $\mathbb{P}[out(P(pk, sk) \rightleftarrows V(pk)) = 1] = 1$.

---

### Passive Security

We require that Victor cannot impersonate Peggy after verifying her identity multiple times. This is **Passive Security** (security against an eavesdropping adversary or an honest-verifier who tries to learn the key from the transcript).

**The Game $Game^{ID}_{\Pi, \mathcal{A}}(\lambda)$:**
1.  Challenger generates $(pk, sk)$ and gives $pk$ to Adversary $\mathcal{A}$.
2.  **Observation Phase:** $\mathcal{A}$ requests $q$ transcripts $\tau_1, \dots, \tau_q$ (generated by honest execution).
3.  **Impersonation Phase:** $\mathcal{A}$ tries to play the role of the Prover against the honest Verifier $V$.
4.  $\mathcal{A}$ wins if $V$ accepts the final interaction.

> ![[Pasted image 20260126011111.png]]
> *Figure 7.1: Graphical representation of $Game^{ID}_{\Pi, \mathcal{A}}(\lambda)$.*

##### Definition 7.2: Passive Security for IDS
> [!def] Definition 7.2
> An IDS $\Pi$ has **passive security** if for all PPT adversaries $\mathcal{A}$:
> $$\mathbb{P}[Game^{ID}_{\Pi, \mathcal{A}}(\lambda) = 1] \leq negl(\lambda)$$

---

### Σ-protocols

We focus on a specific class of IDS called **$\Sigma$-protocols**. These are 3-move protocols involving random challenges.

**Structure (3-Moves):**
1.  **Commitment ($\alpha$):** Prover sends a randomized initial message.
2.  **Challenge ($\beta$):** Verifier sends a random challenge.
3.  **Response ($\gamma$):** Prover sends a computed response.

##### Definition 7.3: Σ-protocols
> [!def] Definition 7.3
> A triple $\Pi = (KGen, P, V)$ is a **$\Sigma$-protocol** if:
> * It is a 3-move protocol $(\alpha, \beta, \gamma)$.
> * **Non-triviality:** It is hard to predict the first message $\alpha$ (entropy is high).

#### Example: Schnorr's Protocol
This is the standard $\Sigma$-protocol for proving knowledge of a Discrete Logarithm.

##### Algorithm 7.1: Schnorr's Σ-protocol
> [!algo] Algorithm 7.1
> **Parameters:** Cyclic group $G$ of order $q$, generator $g$.
> **Keys:** $sk = x \in_R \mathbb{Z}_q$, $pk = g^x$.
>
> **Protocol:**
> 1.  **Prover ($P_1$):** Sample $a \in_R \mathbb{Z}_q$. Send $\alpha = g^a$.
> 2.  **Verifier ($V_1$):** Sample random challenge $\beta \in_R \mathbb{Z}_q$. Send $\beta$.
> 3.  **Prover ($P_2$):** Compute $\gamma = a + \beta x \pmod q$. Send $\gamma$.
> 4.  **Verifier ($V_2$):** Accept if $g^\gamma = \alpha \cdot (pk)^\beta$.


**Correctness Check:**
$g^\gamma = g^{a + \beta x} = g^a \cdot (g^x)^\beta = \alpha \cdot (pk)^\beta$.

---

### Security Properties of Σ-protocols

To prove an IDS is secure, we rely on two properties: **Honest-Verifier Zero-Knowledge (HVZK)** and **Special Soundness (SS)**.

#### 1. Honest-Verifier Zero-Knowledge (HVZK)
This property ensures that the transcript $(\alpha, \beta, \gamma)$ reveals **no information** about the secret key $sk$.
Formalized by the existence of a **Simulator** that can generate valid-looking transcripts *without* knowing $sk$, provided it can choose the challenge $\beta$ (or if $\beta$ is random).

##### Definition 7.4: Honest-Verifier Zero-Knowledge
> [!def] Definition 7.4
> $\Pi$ has **HVZK** if there exists a PPT simulator $Sim$ such that:
> $$(pk, sk, Sim(pk)) \approx_c (pk, sk, \text{RealTranscript}(pk, sk))$$

##### Proposition 7.1
> [!check] Proposition 7.1
> **Schnorr's protocol has HVZK.**

**Proof:**
Simulator $Sim(pk)$:
1.  Pick random $\beta', \gamma' \in_R \mathbb{Z}_q$.
2.  Compute $\alpha' = g^{\gamma'} \cdot (pk)^{-\beta'}$.
3.  Output transcript $(\alpha', \beta', \gamma')$.
This distribution is identical to a real transcript because the equation $g^\gamma = \alpha \cdot pk^\beta$ holds perfectly, and values are uniformly distributed.

#### 2. Special Soundness (SS)
This property ensures that a prover cannot cheat. Specifically, if a prover can answer **two different challenges** $\beta, \beta'$ for the same commitment $\alpha$, they *must* know the secret key.

##### Definition 7.5: Special Soundness
> [!def] Definition 7.5
> $\Pi$ has **Special Soundness** if there is an extractor that, given two valid transcripts $(\alpha, \beta, \gamma)$ and $(\alpha, \beta', \gamma')$ with $\beta \neq \beta'$, can compute the secret key $sk$.

##### Proposition 7.2
> [!check] Proposition 7.2
> **Schnorr's protocol has Special Soundness.**

**Proof:**
Given $(\alpha, \beta, \gamma)$ and $(\alpha, \beta', \gamma')$ such that:
1.  $g^\gamma = \alpha \cdot pk^\beta$
2.  $g^{\gamma'} = \alpha \cdot pk^{\beta'}$

Divide the equations:
$$g^{\gamma - \gamma'} = pk^{\beta - \beta'} = (g^x)^{\beta - \beta'} = g^{x(\beta - \beta')}$$
Exponents must match:
$$\gamma - \gamma' \equiv x(\beta - \beta') \pmod q$$
$$x = (\gamma - \gamma')(\beta - \beta')^{-1} \pmod q$$
We extracted $x$ (the secret key).

---

### Theorem 7.1: From Properties to Security

##### Theorem 7.1
> [!abstract] Theorem 7.1
> Let $\Sigma$ be a $\Sigma$-protocol.
> **If $\Sigma$ has HVZK and Special Soundness, then $\Sigma$ has passive security.**

**Proof:**
Let $G_0(\lambda) = Game^{ID}_{\Sigma, \mathcal{A}}$.
Let $G_1(\lambda)$ be the game played as $G_0(\lambda)$ but where transcript query answers are taken from $Sim(pk)$ instead of $P(pk, sk) \rightleftarrows V(pk)$.

Let $q = poly(\lambda)$ be the number of transcript queries made. We define $q+1$ hybrids $H_0, \dots, H_q$ such that each $H_i$ answers the first $i$ queries using $Sim(pk)$ and the rest using the real prover.
By definition:
* $G_0(\lambda) = H_0(\lambda)$ (All Real)
* $G_1(\lambda) = H_q(\lambda)$ (All Simulated)


**Claim 1: $H_i \approx_c H_{i+1}$ for all $i \in [q-1]$**

**Proof of Claim 1:**
We prove this through a reduction from the **HVZK** property.
By way of contradiction, suppose there is an adversary $\mathcal{A}$ that distinguishes $H_i(\lambda)$ from $H_{i+1}(\lambda)$ with non-negligible probability. We build a new adversary $\mathcal{A}'$ as follows:

1.  The challenger $\mathcal{C}$ sends $(pk, sk, \tau)$ to $\mathcal{A}'$, who forwards $pk$ to $\mathcal{A}$.
2.  $\mathcal{A}$ makes $q$ transcript queries. For the $j$-th query, $\mathcal{A}'$ answers with $\tau_j$ such that:
    $$
    \tau_j \in_R \begin{cases} 
    Sim(pk) & \text{if } j \le i \\
    \{\tau\} & \text{if } j = i+1 \\
    P(pk, sk) \rightleftarrows V(pk) & \text{if } j > i+1 
    \end{cases}
    $$
3.  $\mathcal{A}$ guesses $b$, which $\mathcal{A}'$ forwards to $\mathcal{C}$.

**Analysis:**
* If the challenge $\tau$ came from $Sim(pk)$ (Simulated), the $(i+1)$-th query is simulated. Thus, the first $i+1$ queries are simulated. This corresponds to **$H_{i+1}(\lambda)$**.
* If the challenge $\tau$ came from the Real Prover, the $(i+1)$-th query is real. Thus, only the first $i$ queries are simulated. This corresponds to **$H_i(\lambda)$**.
* Therefore, if $\mathcal{A}$ distinguishes the hybrids, $\mathcal{A}'$ breaks the HVZK property.


**Claim 2: $\mathbb{P}[G_1(\lambda) = 1] \leq negl(\lambda)$**

**Proof of Claim 2:**
We use a reduction from **Special Soundness**.
By contradiction, suppose there is an adversary $B = (B_1, B_2)$ that wins $G_1(\lambda)$ (the simulated game) with probability at least $n^{-c}$ for some $c > 0$. We build an adversary $B'$:

1.  Challenger $\mathcal{C}'$ sends $pk$ to $B'$. $B'$ forwards it to $B$.
2.  $B$ makes $q$ transcript queries. $B'$ answers all of them using $Sim(pk)$ (since we are in $G_1$).
3.  $B$ outputs state $s = B_1(\tau_1, \dots, \tau_q)$.
4.  **Run 1:** $B'$ plays the protocol with $B_2(s, pk)$.
    * $B'$ acts as the Verifier, picking a random challenge $\beta^*_0$ from the space $B_{\lambda, pk}$.
    * $B$ returns transcript $(\alpha^*, \beta^*_0, \gamma^*_0)$.
5.  **Run 2 (Rewind):** $B'$ rewinds $B$ to the step after sending $\alpha^*$.
    * $B'$ picks a new random challenge $\beta^*_1$ (using the same random tape/state for everything prior).
    * $B$ returns transcript $(\alpha^*, \beta^*_1, \gamma^*_1)$.
6.  $B'$ returns both transcripts to $\mathcal{C}'$.



**Analysis:**
Let $Z \in \{0, 1\}^*$ be the random variable representing the state of $B_2$ after sending $\alpha^*$.
Let $\delta_z = \mathbb{P}[G_1(\lambda) = 1 \mid Z = z]$ (Success probability for a fixed state).
We know the overall success probability is:
$$\frac{1}{n^c} \leq \mathbb{P}[G_1(\lambda) = 1] = \sum_{z} \mathbb{P}[Z=z] \delta_z = \mathbb{E}[\delta_z]$$
Thus $\mathbb{E}[\delta_z] \geq n^{-c}$.

Let $G$ be the event that $\beta^*_0 \neq \beta^*_1$ (challenges are different).
When $G=1$ and both runs succeed, we have a collision (Special Soundness breach).
The probability that $B'$ wins the Special Soundness game is:

$$
\begin{aligned}
\mathbb{P}[Game^{SS}_{\Sigma, B'}(\lambda) = 1] &\geq \mathbb{P}[G=1] \cdot \mathbb{P}[Both Runs Win \mid G=1] \\
&= \left( 1 - \frac{1}{|B_{\lambda, pk}|} \right) \cdot \mathbb{E}[\delta_z^2] \\
&\approx \mathbb{E}[\delta_z^2] - \frac{1}{2^{\omega(\log \lambda)}}
\end{aligned}
$$

By **Jensen's Inequality** ($\mathbb{E}[X^2] \geq (\mathbb{E}[X])^2$):
$$
\begin{aligned}
\mathbb{P}[Game^{SS}_{\Sigma, B'}(\lambda) = 1] &\geq (\mathbb{E}[\delta_z])^2 - negl(\lambda) \\
&\geq (n^{-c})^2 - negl(\lambda) \\
&\geq \frac{1}{n^{2c}} - negl(\lambda)
\end{aligned}
$$
This probability is non-negligible, meaning $B'$ breaks Special Soundness.
Thus, no such $B$ can exist. $\blacksquare$


## 7.2 The Fiat-Shamir Transform

From the very definition of identification schemes, it’s easy to see that they are closely related to the concept of digital signatures.
* **Identification Scheme:** Interactive (Prover $\leftrightarrow$ Verifier).
* **Digital Signature:** Non-interactive (Signer $\to$ Verifier).

The **Fiat-Shamir Transform** allows us to construct a Zero-Knowledge digital signature scheme starting from any non-trivial, passively secure $\Sigma$-protocol (like Schnorr).
**The Core Idea:** Replace the random challenge $\beta$ sent by the Verifier with a hash of the commitment $\alpha$ and the message $m$. This makes the protocol non-interactive because the signer can "compute" the challenge themselves.

##### Definition 7.6: Fiat-Shamir transform
> [!def] Definition 7.6
> Let $\Sigma = (KGen, P, V)$ be a $\Sigma$-protocol and let $H$ be a hash function.
> The **Fiat-Shamir transform** $\Pi_{\Sigma, H} = (KGen, Sign, Vrfy)$ is a digital signature scheme constructed as follows:
>
> * **$Sign(sk, m)$:**
>     1. Run $P_1(pk, sk)$ to generate commitment $\alpha$.
>     2. Compute challenge $\beta = H(\alpha, m)$.
>     3. Run $P_2(pk, sk, \alpha, \beta)$ to generate response $\gamma$.
>     4. Output signature $\sigma = (\alpha, \gamma)$.
>
> * **$Vrfy(pk, \sigma, m)$:**
>     1. Parse $\sigma = (\alpha, \gamma)$.
>     2. Recompute $\beta = H(\alpha, m)$.
>     3. Output $V(pk, \alpha, \beta, \gamma)$.


##### Theorem 7.2
> [!abstract] Theorem 7.2
> Let $\Sigma$ be a $\Sigma$-protocol and $H$ be a hash function.
> If $\Sigma$ is **non-trivial** and **passively secure**, the Fiat-Shamir transform $\Pi_{\Sigma, H}$ is **UFCMA-secure** in the Random Oracle Model (ROM).

**Proof:**
We prove this by contradiction. Suppose there is an adversary $\mathcal{A}_H$ that breaks the UFCMA security of the signature scheme. We construct an adversary $\mathcal{A}$ that breaks the **Passive Security** (ID-game) of the underlying $\Sigma$-protocol.

**Assumptions on $\mathcal{A}_H$:**
1.  It never repeats queries.
2.  It always queries the Random Oracle (RO) for $(\alpha, m)$ *before* asking for a signature on $m$ using that specific $\alpha$.

**The Reduction Algorithm $\mathcal{A}$:**
1.  **Setup:** $\mathcal{A}$ acts as the RO for $\mathcal{A}_H$. The Challenger $\mathcal{C}$ (from the ID game) sends $pk$ to $\mathcal{A}$, who forwards it to $\mathcal{A}_H$.
2.  **Transcript Gathering:** $\mathcal{A}_H$ will make $q = poly(\lambda)$ queries to the RO. $\mathcal{A}$ requests $q$ valid transcripts $\tau_i = (\alpha_i, \beta_i, \gamma_i)$ from the ID Challenger $\mathcal{C}$.
3.  **Guessing Strategy:** $\mathcal{A}$ picks a random index $j \in_R [q]$. This represents the guess for which RO query will correspond to the final forgery.
4.  **Simulating the RO ($H'$):**
    * **For query $i \neq j$:** When $\mathcal{A}_H$ queries $(\alpha_i, m_i)$, return $\beta_i$ (from the stored transcript).
    * **For query $i = j$:** When $\mathcal{A}_H$ queries $(\alpha_j, m_j)$, $\mathcal{A}$ pauses and initiates a **live interaction** with $\mathcal{C}$.
        * $\mathcal{A}$ sends $\alpha_j$ to $\mathcal{C}$.
        * $\mathcal{C}$ replies with a challenge $\beta^\#$.
        * $\mathcal{A}$ returns $\beta^\#$ to $\mathcal{A}_H$ as the hash output.
5.  **Simulating Signatures:**
    * If $\mathcal{A}_H$ asks for a signature on $m_i$ (where $i \neq j$): $\mathcal{A}$ returns $(\alpha_i, \gamma_i)$. This is a valid signature because $H(\alpha_i, m_i) = \beta_i$ and the transcript is valid.
    * If $\mathcal{A}_H$ asks for a signature corresponding to index $j$: $\mathcal{A}$ cannot answer (it doesn't know the response to the live challenge $\beta^\#$). It **ABORTS**.
6.  **Forgery:**
    * Eventually, $\mathcal{A}_H$ outputs a forgery $(\alpha^*, \gamma^*)$ for message $m^*$.
    * If the forgery corresponds to the $j$-th query (i.e., $(\alpha^*, m^*) = (\alpha_j, m_j)$), then the effective challenge was $\beta^\#$.
    * $\mathcal{A}$ sends $\gamma^*$ to $\mathcal{C}$.

**Conclusion:**
If $V(pk, \alpha^*, \beta^\#, \gamma^*) = 1$, then $\mathcal{A}$ has successfully completed the identification protocol with $\mathcal{C}$, breaking passive security.
The probability of this happening is roughly $\frac{1}{q} \cdot \mathbb{P}[\mathcal{A}_H \text{ succeeds}]$. Since $\mathcal{A}_H$ succeeds with non-negligible probability, so does $\mathcal{A}$.

##### Corollary 7.2
> [!check] Corollary 7.2
> The Fiat-Shamir transform of Schnorr's protocol ($\Pi_{\Sigma_{Schnorr}, H}$) is **UFCMA-secure** in the ROM.